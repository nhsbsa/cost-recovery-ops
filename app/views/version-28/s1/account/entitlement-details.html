<!-- ADDING CUSTOM CSS - Add your custom CSS or Sass in /app/assets/sass/main.scss -->

<!-- Extends the layout from /views/layout-sidebar.html -->
{% extends 'layout-sidebar.html' %}
<!-- 
  In /views/layout.html you can:
    - change the header and footer 
    - add custom CSS and JavaScript
-->

<!-- Set the page title inside the pageTitle block -->
{% block pageTitle %} Entitlements {% endblock %}

<!-- Breadcrumb goes inside the beforeContent block -->
{% block beforeContent %}
<nav class="nhsuk-breadcrumb nhsBSA-breadcrumb" aria-label="Breadcrumb">
  <div class="nhsuk-width-container-fluid">
    <div class="nhsuk-grid-row">
      <div class="nhsuk-grid-column-full">
        <ol class="nhsuk-breadcrumb__list">
          <li class="nhsuk-breadcrumb__item">
            <a class="nhsuk-breadcrumb__link" href="../search/search-by-person">Search</a>
          </li>
          <li class="nhsuk-breadcrumb__item">
            <a class="nhsuk-breadcrumb__link" href="../search/search-results">Search results</a>
          </li>
          <li class="nhsuk-breadcrumb__item">
            <a class="nhsuk-breadcrumb__link" href="../account/patient-summary">Overview</a>
          </li>
          <li class="nhsuk-breadcrumb__item">
            <a class="nhsuk-breadcrumb__link" href="../account/entitlement-details">Entitlements</a>
          </li>
        </ol>
      </div>
    </div>

    <p class="nhsuk-breadcrumb__back">
      <a class="nhsuk-breadcrumb__backlink" href="">Back to search results</a>
    </p>
  </div>
</nav>
{% endblock %}

{% block content %}
<div class="nhsBSA-sidebar-container">
  <div class="nhsBSA-sidebar-wrapper">
    <div class="nhsBSA-sidebar-content">
      <div class="nhsuk-width-container-fluid">
        <div class="nhsuk-main-wrapper" id="maincontent">
          
          <div class="nhsuk-grid-row">
            <div class="nhsuk-grid-column-full">
              <h1 class="nhsuk-heading-xl">Entitlements and treatments</h1>

              <a href="../s072-registration/which-entitlement" class="nhsuk-button" style="float: right;" role="button" data-module="nhsuk-button">
                Add an entitlement
              </a>

            </div>
          </div>
          
          
          <hr class="blue-horizontal-line">

          <div class="nhsuk-scrollable-pane">
            <br>

            <div class="nhsuk-grid-row">
              <div class="nhsuk-grid-column-full">
  
                {% if data['add-new-entitlement'] == 'yes' %}
                  <h2 class="nhsuk-heading-m" id="entitlement-s2">S1/S072 entitlements</h2>

                    <div class="nhsuk-expander-group">
                      <details class="nhsuk-details nhsuk-expander">
                        <summary class="nhsuk-details__summary">
                          <span role="button" class="nhsuk-details__summary-text" id="entitlement-type" aria-label="S1/S072 - Valid: 05/09/2024 - France (FR)">S1/S072 - Valid: 05/09/2024 - France (FR)</span>
                            <strong class="nhsuk-tag no-caps nhsuk-tag--yellow" style="float: right; margin-right: 20px; margin-top: 8px; display: block;" id="entitlement-status-tag">Action required</strong>
                        </summary>


                        <div class="nhsuk-details__text">
                          <br>

                          <div class="nhsuk-action-link">

                            <dl class="nhsuk-summary-list">
                              <div class="nhsuk-summary-list__row">
                                <dt class="nhsuk-summary-list__key">
                                  Entitlement type
                                </dt>
                                <dd class="nhsuk-summary-list__value">
                                  S1/S072
                                </dd>
                                <dd class="nhsuk-summary-list__actions">
                                  
                                </dd>
                              </div>
          
          
                              <div class="nhsuk-summary-list__row">
                                <dt class="nhsuk-summary-list__key">
                                  Personal identification number (PIN)
                                </dt>
                                <dd class="nhsuk-summary-list__value">
                                  1123456789
                                </dd>
                                <dd class="nhsuk-summary-list__actions">
                                  <a href="#">
                                    Change<span class="nhsuk-u-visually-hidden">personal identification number</span>
                                  </a>
                                </dd>
                              </div>
          
          
                              <div class="nhsuk-summary-list__row">
                                <dt class="nhsuk-summary-list__key">
                                  Country of issue
                                </dt>
                                <dd class="nhsuk-summary-list__value">
                                  {% if data['update-S1-entitlement-details'] == 'Yes' %}
                                    {% if data['updated-S1-entitlement-country-of-issue'] %}
                                      {{ data['updated-S1-entitlement-country-of-issue'] }}
                                    {% else %}
                                      France
                                    {% endif %}
                                  {% else %}
                                    {% if data['S1-entitlement-country-of-issue'] %}
                                      {{ data['S1-entitlement-country-of-issue'] }}
                                    {% else %}
                                      France
                                    {% endif %}
                                  {% endif %}
                                </dd>
                                <dd class="nhsuk-summary-list__actions">
                                  
                                </dd>
                              </div>
          
                            
                              <div class="nhsuk-summary-list__row">
                                <dt class="nhsuk-summary-list__key">
                                  Issue date
                                </dt>
                                <dd class="nhsuk-summary-list__value">
                                  {% if data['update-S1-entitlement-details'] == 'Yes' %}
                                    {% if data['updated-s1-entitlement-issue-date-day'] and data['updated-s1-entitlement-issue-date-month'] and data['updated-s1-entitlement-issue-date-year'] %}
                                        {% set day = data['updated-s1-entitlement-issue-date-day'] %}
                                        {% set month = data['updated-s1-entitlement-issue-date-month'] | int %}
                                        {% set year = data['updated-s1-entitlement-issue-date-year'] %}
                            
                                        {# Define month names #}
                                        {% set month_names = [
                                            "January", "February", "March", "April", "May", "June",
                                            "July", "August", "September", "October", "November", "December"
                                        ] %}
                            
                                        {# Get the month name #}
                                        {% set month_name = month_names[month - 1] %}
                            
                                        {# Display the date in the format "day month year" #}
                                        {{ day | int }} {{ month_name }} {{ year }}
                                      {% else %}
                                        30 August 2024
                                      {% endif %}
                                  {% else %}
                                    {% if data['s1-entitlement-issue-date-day'] and data['s1-entitlement-issue-date-month'] and data['s1-entitlement-issue-date-year'] %}
                                      {% set day = data['s1-entitlement-issue-date-day'] %}
                                      {% set month = data['s1-entitlement-issue-date-month'] | int %}
                                      {% set year = data['s1-entitlement-issue-date-year'] %}
                          
                                      {# Define month names #}
                                      {% set month_names = [
                                          "January", "February", "March", "April", "May", "June",
                                          "July", "August", "September", "October", "November", "December"
                                      ] %}
                          
                                      {# Get the month name #}
                                      {% set month_name = month_names[month - 1] %}
                          
                                      {# Display the date in the format "day month year" #}
                                      {{ day | int }} {{ month_name }} {{ year }}
                                    {% else %}
                                      30 August 2024
                                    {% endif %}
                                  {% endif %}
                                </dd>
                                <dd class="nhsuk-summary-list__actions">
                                  
                                </dd>
                              </div>
          
          
                              <div class="nhsuk-summary-list__row">
                                <dt class="nhsuk-summary-list__key">
                                  Start date
                                </dt>
                                <dd class="nhsuk-summary-list__value">
                                  {% if data['update-S1-entitlement-details'] == 'Yes' %}
                                    {% if data['updated-s1-entitlement-start-date-day'] and data['updated-s1-entitlement-start-date-month'] and data['updated-s1-entitlement-start-date-year'] %}
                                    {% set day = data['updated-s1-entitlement-start-date-day'] %}
                                    {% set month = data['updated-s1-entitlement-start-date-month'] | int %}
                                    {% set year = data['updated-s1-entitlement-start-date-year'] %}
                        
                                    {# Define month names #}
                                    {% set month_names = [
                                        "January", "February", "March", "April", "May", "June",
                                        "July", "August", "September", "October", "November", "December"
                                    ] %}
                        
                                    {# Get the month name #}
                                    {% set month_name = month_names[month - 1] %}
                        
                                    {# Display the date in the format "day month year" #}
                                    {{ day | int }} {{ month_name }} {{ year }}
                                  {% else %}
                                    5 September 2024
                                {% endif %}
                                  {% else %}
                                    {% if data['s1-entitlement-start-date-day'] and data['s1-entitlement-start-date-month'] and data['s1-entitlement-start-date-year'] %}
                                      {% set day = data['s1-entitlement-start-date-day'] %}
                                      {% set month = data['s1-entitlement-start-date-month'] | int %}
                                      {% set year = data['s1-entitlement-start-date-year'] %}
                          
                                      {# Define month names #}
                                      {% set month_names = [
                                          "January", "February", "March", "April", "May", "June",
                                          "July", "August", "September", "October", "November", "December"
                                      ] %}
                          
                                      {# Get the month name #}
                                      {% set month_name = month_names[month - 1] %}
                          
                                      {# Display the date in the format "day month year" #}
                                      {{ day | int }} {{ month_name }} {{ year }}
                                    {% else %}
                                      5 September 2024
                                    {% endif %}
                                  {% endif %}
                                </dd>
                                <dd class="nhsuk-summary-list__actions">
                                  
                                </dd>
                              </div>
          
          
                              <div class="nhsuk-summary-list__row">
                                <dt class="nhsuk-summary-list__key">
                                  End date (optional)
                                </dt>
                                <dd class="nhsuk-summary-list__value">
                                  {% if data['update-S1-entitlement-details'] == 'Yes' %}
                                    {% if data['updated-s1-entitlement-end-date-day'] and data['updated-s1-entitlement-end-date-month'] and data['updated-s1-entitlement-end-date-year'] %}
                                      {% set day = data['updated-s1-entitlement-end-date-day'] %}
                                      {% set month = data['updated-s1-entitlement-end-date-month'] | int %}
                                      {% set year = data['updated-s1-entitlement-end-date-year'] %}
                          
                                      {# Define month names #}
                                      {% set month_names = [
                                          "January", "February", "March", "April", "May", "June",
                                          "July", "August", "September", "October", "November", "December"
                                      ] %}
                          
                                      {# Get the month name #}
                                      {% set month_name = month_names[month - 1] %}
                          
                                      {# Display the date in the format "day month year" #}
                                      {{ day | int }} {{ month_name }} {{ year }}
                                    {% else %}
                                    <span class="nhsuk-u-visually-hidden">Not provided</span>
                                    {% endif %}
                                  {% else %}
                                    {% if data['s1-entitlement-end-date-day'] and data['s1-entitlement-end-date-month'] and data['s1-entitlement-end-date-year'] %}
                                      {% set day = data['s1-entitlement-end-date-day'] %}
                                      {% set month = data['s1-entitlement-end-date-month'] | int %}
                                      {% set year = data['s1-entitlement-end-date-year'] %}
                          
                                      {# Define month names #}
                                      {% set month_names = [
                                          "January", "February", "March", "April", "May", "June",
                                          "July", "August", "September", "October", "November", "December"
                                      ] %}
                          
                                      {# Get the month name #}
                                      {% set month_name = month_names[month - 1] %}
                          
                                      {# Display the date in the format "day month year" #}
                                      {{ day | int }} {{ month_name }} {{ year }}
                                    {% else %}
                                    <span class="nhsuk-u-visually-hidden">Not provided</span>
                                    {% endif %}
                                  {% endif %}
                                </dd>
                                <dd class="nhsuk-summary-list__actions">
                                  
                                </dd>
                              </div>
                            </dl>
                            <!-- Entitlement details content ends -->
                          
                            <div class="button-container">
                              <a href="../account/entitlement-content/S1-entitlement-details"><button style="margin-right:20px;" class="nhsuk-button" type="submit">View all entitlement details</button></a>
                              <a href="../account/entitlement-content/cancel-S1-entitlement"><button class="nhsuk-button nhsuk-button--warning" data-module="nhsuk-button" type="submit">Cancel entitlement</button></a>
                            </div>
                          
                          </div>

                        </div>
                        
                      </details>
                    </div>
                    <!-- Entitlement expander ends -->

                    {% else %}
                    <p><b>No entitlements have been added to this person's record.</b></p>
                    {% endif %}

               </div>
            </div>

          </div>

        </div>
      </div>
    </div>


    <!-- Left-hand navigation -->
    <div class="nhsBSA-sidebar-nav">
      <div class="side-nav">
        <h3>
          John Doe<span class="nhsuk-caption-m nhsuk-caption--bottom">
          <span class="nhsuk-u-visually-hidden"> - </span>123456</span>
        </h3>
        <ul id="options" class="options">
          <li><a href="patient-summary">Overview</a></li>
          <li><a href="patient-details">Personal details</a></li>
          <li><a class="active" href="entitlement-details">Entitlements and enquiries</a></li>
          <li><a href="case-history">Case history</a></li>
        </ul>
      </div>
    </div>
    <!-- End of navigation -->

  </div>
</div>
<!-- End of main content -->
      

<script>
  document.addEventListener("DOMContentLoaded", function () {
    const tabs = document.querySelectorAll(".nhsuk-tabs__tab");
    const panels = document.querySelectorAll(".nhsuk-tabs__panel");

    function hideAllPanels() {
      panels.forEach(panel => panel.classList.add("nhsuk-tabs__panel--hidden"));
      tabs.forEach(tab => tab.parentElement.classList.remove("nhsuk-tabs__list-item--selected"));
    }

    function showPanel(panelId) {
      const panel = document.querySelector(panelId);
      if (panel) {
        panel.classList.remove("nhsuk-tabs__panel--hidden");
      }
    }

    tabs.forEach(tab => {
      tab.addEventListener("click", function (event) {
        event.preventDefault();
        hideAllPanels();
        tab.parentElement.classList.add("nhsuk-tabs__list-item--selected");
        showPanel(tab.getAttribute("href"));
      });
    });

    // Initially show the Personal details tab
    hideAllPanels();
    showPanel("#entitlements");
    document.querySelector('a[href="#entitlements"]').parentElement.classList.add("nhsuk-tabs__list-item--selected");
  });


   // Current Date and Time

  // JavaScript code
  var currentDateElement = document.getElementById("currentDate1");

  // Get the current date
  var currentDate = new Date();

  // Format the date as desired
  var dateOptions = { day: 'numeric', month: 'long', year: 'numeric' };
  var formattedDate = currentDate.toLocaleDateString(undefined, dateOptions);

  // Format the time as desired
  var timeOptions = { hour: 'numeric', minute: 'numeric', hour24: true };
  var formattedTime = currentDate.toLocaleTimeString(undefined, timeOptions);

  // Combine date and time
  var formattedDateTime = formattedDate + ' at ' + formattedTime;

  // Set the formatted date and time as the content of the element
  currentDateElement.textContent = formattedDateTime;
</script>
{% endblock %}
